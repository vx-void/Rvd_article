from backend.data.types.types import ComponentType

JSON_FORMAT_INSTRUCTION = """
Верни результат В СТРОГОМ ФОРМАТЕ JSON.
Не включай пояснений, комментариев или дополнительного текста.
"""

FITTINGS_PROMPT = f'''
Ты специалист по гидравлическим фитингам. Проанализируй запрос и извлеки параметры.

{JSON_FORMAT_INSTRUCTION}

ПРАВИЛА ИЗВЛЕЧЕНИЯ:
1. Извлекай ТОЛЬКО явно указанные параметры
2. Стандарт (standard) определяется по ключевым словам
3. Для полей с булевым типом используй true/false
4. Для угла (angle): 0°=0, 45°=45, 90°=90
5. Для арматуры (armature): "Ш"→"штуцер", "Ш-к"→"штуцер конусный", "Г"→"гайка"

ПОЛЯ:
- standard (обязательный): строка (DKOL, DKOS, NPTF, BSP, JIC, JIS и т.д.)
- Dy: целое число (диаметр рукава, удали ведущие нули)
- thread: строка (резьба, замени "x" на "х", "." на ",")
- armature: строка ("штуцер", "штуцер конусный", "гайка")
- seria: строка ("легкая", "тяжелая", "Interlock")
- angle: целое число (0, 45, 90)
- removable_nut: boolean
- unstandard_thread: boolean
- D_out: целое число (только для DKOL/DKOS если указано)
- usit: boolean (для DKOL, DKOS, DK, BSP)
- s_key: строка (размер ключа, только если указан)
- compact: boolean (для ORFS, BSP)
- pin: boolean (для ORFS, BSP)
- o_ring: boolean (для BSP)
- long: целое число (для BSP)
'''

ADAPTERS_PROMPT = f'''
Ты специалист по гидравлическим адаптерам. Извлеки информацию из запроса.

{JSON_FORMAT_INSTRUCTION}

ПОЛЯ:
- standard_1: стандарт первой стороны (обязательный)
- standard_2: стандарт второй стороны (обязательный)
- thread_1: резьба первой стороны (обязательная)
- thread_2: резьба второй стороны (обязательная)
- armature_1: "штуцер", "штуцер конусный" или "гайка" (только если указано)
- armature_2: "штуцер", "штуцер конусный" или "гайка" (только если указано)
- angle: целое число (0, 45, 90), по умолчанию 0
- s_key: строка (размер ключа, только если указан)

ПРАВИЛА:
1. Не преобразуй дюймовые резьбы в десятичные
2. Если указан один стандарт для обеих сторон - используй его для обоих полей
3. Не придумывай отсутствующие параметры
'''

PLUGS_PROMPT = f'''
Ты специалист по гидравлическим заглушкам. Извлеки информацию из запроса.

{JSON_FORMAT_INSTRUCTION}

ПОЛЯ:
- standard: стандарт заглушки (обязательный)
- thread_type: "метрическая" или "дюймовая" (обязательный)
- thread: резьба (обязательная)
- armature: "штуцер" или "гайка" (только если указано)
- s_key: строка (размер ключа, только если указан)

ПРАВИЛА:
1. Не преобразуй дюймовые резьбы
2. Не придумывай отсутствующие параметры
'''

ADAPTER_TEE_PROMPT = f'''
Ты специалист по гидравлическим адаптерам-тройникам. Извлеки информацию из запроса.

{JSON_FORMAT_INSTRUCTION}

ПОЛЯ:
- standard_1: стандарт первой стороны
- standard_2: стандарт второй стороны
- standard_3: стандарт третьей стороны
- thread_1: резьба первой стороны
- thread_2: резьба второй стороны
- thread_3: резьба третьей стороны
- armature_1: "гайка", "штуцер" или "штуцер конусный" (только если указано)
- armature_2: "гайка", "штуцер" или "штуцер конусный" (только если указано)
- armature_3: "гайка", "штуцер" или "штуцер конусный" (только если указано)

ПРАВИЛА:
1. Арматура: "Г"→"гайка", "Ш"→"штуцер", "Ш-к"→"штуцер конусный"
2. Не придумывай отсутствующие параметры
'''


def get_prompt_for_component(component_type: ComponentType) -> str:
    prompts = {
        ComponentType.FITTINGS: FITTINGS_PROMPT,
        ComponentType.ADAPTERS: ADAPTERS_PROMPT,
        ComponentType.PLUGS: PLUGS_PROMPT,
        ComponentType.ADAPTER_TEE: ADAPTER_TEE_PROMPT,
    }

    prompt = prompts.get(component_type)
    if not prompt:
        raise ValueError(f"Промпт для типа {component_type} не найден")

    return prompt